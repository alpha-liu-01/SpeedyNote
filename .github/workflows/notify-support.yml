name: Notify New Tag Release to ntfy.sh

# 触发条件：当仓库推送新 Tag 时执行（覆盖原 Release 触发逻辑）
on:
  push:
    tags:
      - '*'  # 匹配所有 Tag（如需限定格式，可改为 'v*' 仅匹配 v1.0.0 这类 Tag）

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Tag Release Notification to ntfy.sh
        run: |
          # 提取推送的 Tag 名称（如 v2.1.0）
          TAG_NAME="${GITHUB_REF#refs/tags/}"
          # 拼接该 Tag 对应的 GitHub Releases 链接（需确保 Tag 已关联 Release，否则链接可能指向 404）
          RELEASE_URL="https://github.com/${{ github.repository }}/releases/tag/$TAG_NAME"
          # 消息内容：XXX 新版本发布（XXX 替换为实际 Tag 名称）
          MESSAGE="$TAG_NAME 新版本发布，详细见 $RELEASE_URL"
          # 向 ntfy.sh/SpeedyNote 主题推送消息
          curl -d "$MESSAGE" https://ntfy.sh/SpeedyNote
